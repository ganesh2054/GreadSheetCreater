using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using static DesktopApp4.Form2;

namespace DesktopApp4
{
    class date
    {
        public int[,] nepali = {
           { 2040,31,31,32,31,31,31,30,29,30,29,30,30 },
       {  2041,31,31,32,32,31,30,30,29,30,29,30,30 },
       {  2042,31,32,31,32,31,30,30,30,29,29,30,31 },
        { 2043,31,31,31,32,31,31,29,30,30,29,30,30 },
        { 2044,31,31,32,31,31,31,30,29,30,29,30,30 },
       {  2045,31,32,31,32,31,30,30,29,30,29,30,30 },
       {  2046,31,32,31,32,31,30,30,30,29,29,30,31 },
       {  2047,31,31,31,32,31,31,30,29,30,29,30,30 },
       {  2048,31,31,32,31,31,31,30,29,30,29,30,30 },
       {  2049,31,32,31,32,31,30,30,30,29,29,30,30 },
        { 2050,31,32,31,32,31,30,30,30,29,30,29,31 },
        { 2051,31,31,31,32,31,31,30,29,30,29,30,30 },
       {  2052,31,31,32,31,31,31,30,29,30,29,30,30 },
        {   2053,31,32,31,32,31,30,30,30,29,29,30,30 },
       {  2054,31,32,31,32,31,30,30,30,29,30,29,31},
       {2055,31,31,32,31,31,31,30,29,30,29,30,30 } ,
       { 2056,31,31,32,31,32,30,30,29,30,29,30,30 },
       { 2057,31,32,31,32,31,30,30,30,29,29,30,31} ,
       { 2058,30,32,31,32,31,30,30,30,29,30,29,31} ,
      {  2059,31,31,32,31,31,31,30,29,30,29,30,30} ,
       { 2060,31,31,32,32,31,30,30,29,30,29,30,30 },
      {  2061,31,32,31,32,31,30,30,30,29,29,30,31 },
       { 2062,30,32,31,32,31,31,29,30,29,30,29,31} ,
       { 2063,31,31,32,31,31,31,30,29,30,29,30,30} ,
      {  2064,31,31,32,32,31,30,30,29,30,29,30,30 },
       { 2065,31,32,31,32,31,30,30,30,29,29,30,31 },
      {  2066,31,31,31,32,31,31,29,30,30,29,29,31} ,
      {  2067,31,31,32,31,31,31,30,29,30,29,30,30 },
      {  2068,31,31,32,32,31,30,30,29,30,29,30,30 },
       { 2069,31,32,31,32,31,30,30,30,29,29,30,31} ,
      {  2070,31,31,31,32,31,31,29,30,30,29,30,30 },
       { 2071,31,31,32,31,31,31,30,29,30,29,30,30} ,
      {  2072,31,32,31,32,31,30,30,29,30,29,30,30 },
      {  2073,31,32,31,32,31,30,30,30,29,29,30,31 },
     {   2074,31,31,31,32,31,31,30,29,30,29,30,30} ,
     {   2075,31,31,32,31,31,31,30,29,30,29,30,30 },
   {     2076,31,32,31,32,31,30,30,30,29,29,30,30 },
     {   2077,31,32,31,32,31,30,30,30,29,30,29,31} ,
       { 2078,31,31,31,32,31,31,30,29,30,29,30,30} ,
      {  2079,31,31,32,31,31,31,30,29,30,29,30,30 },
     {   2080,31,32,31,32,31,30,30,30,29,29,30,30 },
           { 2081, 31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 30, 30 },
       {  2082, 30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30 },
       {  2082, 30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30} ,
        { 2083, 31, 31, 32, 31, 31, 30, 30, 30, 29, 30, 30, 30 },
        { 2084, 31, 31, 32, 31, 31, 30, 30, 30, 29, 30, 30, 30 },
       {  2085, 31, 32, 31, 32, 30, 31, 30, 30, 29, 30, 30, 30} ,
       {  2086, 30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30} ,
       {  2087, 31, 31, 32, 31, 31, 31, 30, 30, 29, 30, 30, 30} ,
      {   2088, 30, 31, 32, 32, 30, 31, 30, 30, 29, 30, 30, 30 },

      {   2089, 30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30 },
     {    2090, 30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30 }
        };


        public mystruct cnvToEnglish(int mm, int dd, int yy)
        {


            if (yy < 2000 || yy > 2089)
            {
                MessageBox.Show("Supported only nepali year between 2040-2089");

            }
            if (mm < 1 || mm > 12)
            {
                MessageBox.Show("Invalid Date");
            }
            if (dd < 1 || dd > 32)
            {
                MessageBox.Show("Invalid Date");
            }


            int[] month = { 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };  //non leap year
            int[] lmonth = { 0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 }; //leap year

            int isLeapYear(int year)
            {


                if (year % 100 == 0)
                {
                    if (year % 400 == 0)
                        return 1;
                    else
                        return 0;
                }
                else
                {
                    if (year % 4 == 0)
                        return 1;
                    else
                        return 0;
                }
            }

            /**currently can only calculate the date between BS 2013-2079...**/
            int def_eyy = 1983, def_emm = 4, def_edd = 14 - 1;          //spear head english date...
            int def_nyy = 2040;       //spear head nepali date...
            int total_eDays = 0, total_nDays = 0, a = 0, day = 4 - 1;      //all the initializations...
            int m = 0, y = 0, i = 0, j = 0;
            int k = 0;      //to access the array data
            int numDay = 0;
            for (i = 0; i < (yy - def_nyy); i++)
            {   //total days calculation...(nepali)
                for (j = 1; j <= 12; j++)
                {
                    total_nDays += nepali[k, j];
                }
                k++;
            }
            //final year's month calculation...(nepali)
            for (j = 1; j < mm; j++)
            {
                total_nDays += nepali[k, j];
            }

            total_nDays += dd;
       
            total_eDays = def_edd;
            m = def_emm;
            y = def_eyy;
            while (total_nDays != 0)
            {
                if (isLeapYear(y) == 1)
                    a = lmonth[m];
                else
                    a = month[m];

                total_eDays++;
                day++;
                if (total_eDays > a)
                {
                    m++;
                    total_eDays = 1;
                    if (m > 12)
                    {
                        y++;
                        m = 1;
                    }
                }
                if (day > 7)
                    day = 1;
                total_nDays--;
            }
            numDay = day;
            
            mystruct my = new mystruct();
            my.year = y;
            my.month = m;
            my.day = total_eDays;
            return my;

        }

        //---------------------------------------//

    }
}

